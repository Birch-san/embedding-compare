from typing import Dict
from models.imagebind_model import ModalityType
from numpy import array
from numpy.typing import NDArray

similarity_dicts: Dict[ModalityType, Dict[ModalityType, NDArray]] = {
  ModalityType.VISION: {},
  ModalityType.TEXT: {},
  ModalityType.AUDIO: {},
}

# Vision x Text: 
#  image         Reimu    Flandre    Kochiya Sanae    Patchouli Knowlege    Rem    Saber    Matou Sakura    Youmu    anime girl    illustration    national anthem    bossa nova    chiptune
# ----------  -------  ---------  ---------------  --------------------  -----  -------  --------------  -------  ------------  --------------  -----------------  ------------  ----------
# reimu1         0.98          0             0                     0      0           0            0        0             0.02               0                  0             0           0
# flandre1       0             1             0                     0      0           0            0        0             0                  0                  0             0           0
# sanae1         0             0             0.88                  0      0           0            0        0.08          0.03               0                  0             0           0
# patchouli0     0.4           0             0                     0.46   0           0            0        0             0.14               0                  0             0           0
# rem0           0             0             0.02                  0      0.97        0            0        0.01          0.01               0                  0             0           0
# saber1         0             0             0                     0      0           1            0        0             0                  0                  0             0           0
# sakura1        0.03          0             0.23                  0.5    0           0            0.21     0             0.03               0                  0             0           0
# youmu4         0             0             0.01                  0      0           0            0        0.99          0                  0                  0             0           0
#
# numpy.set_printoptions(suppress=True, precision=2, linewidth=200)
# torch.softmax(embeddings[ModalityType.VISION] @ embeddings[ModalityType.TEXT].T, dim=-1).cpu().numpy()
similarity_dicts[ModalityType.VISION][ModalityType.TEXT] = array([
  [0.98, 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.02, 0.  , 0.  , 0.  , 0.  ],
  [0.  , 1.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
  [0.  , 0.  , 0.88, 0.  , 0.  , 0.  , 0.  , 0.08, 0.03, 0.  , 0.  , 0.  , 0.  ],
  [0.4 , 0.  , 0.  , 0.46, 0.  , 0.  , 0.  , 0.  , 0.14, 0.  , 0.  , 0.  , 0.  ],
  [0.  , 0.  , 0.02, 0.  , 0.97, 0.  , 0.  , 0.01, 0.01, 0.  , 0.  , 0.  , 0.  ],
  [0.  , 0.  , 0.  , 0.  , 0.  , 1.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
  [0.03, 0.  , 0.23, 0.5 , 0.  , 0.  , 0.21, 0.  , 0.03, 0.  , 0.  , 0.  , 0.  ],
  [0.  , 0.  , 0.01, 0.  , 0.  , 0.  , 0.  , 0.99, 0.  , 0.  , 0.  , 0.  , 0.  ]
])

# Text x Vision: 
#  label                 reimu1    flandre1    sanae1    patchouli0    rem0    saber1    sakura1    youmu4
# ------------------  --------  ----------  --------  ------------  ------  --------  ---------  --------
# Reimu                   0.98        0.01      0             0.01    0         0          0         0
# Flandre                 0           1         0             0       0         0          0         0
# Kochiya Sanae           0           0         0.7           0       0         0          0         0.29
# Patchouli Knowlege      0.01        0         0.01          0.9     0         0          0.08      0
# Rem                     0           0         0             0       1         0          0         0
# Saber                   0           0         0             0       0         1          0         0
# Matou Sakura            0.25        0.11      0.27          0.01    0         0.03       0.1       0.22
# Youmu                   0           0         0             0       0         0          0         1
# anime girl              0.54        0.18      0.21          0.06    0         0          0         0.01
# illustration            0.02        0.06      0.4           0.03    0.05      0.08       0.01      0.35
# national anthem         0.09        0.2       0.37          0.11    0.07      0.11       0.02      0.03
# bossa nova              0.11        0.05      0.26          0.03    0.05      0.34       0.09      0.07
# chiptune                0.03        0.06      0.08          0.08    0.09      0          0.65      0.01
# softmax(embeddings[ModalityType.TEXT] @ embeddings[ModalityType.VISION].T, dim=-1).cpu().numpy()
similarity_dicts[ModalityType.TEXT][ModalityType.VISION] = array([
  [0.98, 0.01, 0.  , 0.01, 0.  , 0.  , 0.  , 0.  ],
  [0.  , 1.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
  [0.  , 0.  , 0.7 , 0.  , 0.  , 0.  , 0.  , 0.29],
  [0.01, 0.  , 0.01, 0.9 , 0.  , 0.  , 0.08, 0.  ],
  [0.  , 0.  , 0.  , 0.  , 1.  , 0.  , 0.  , 0.  ],
  [0.  , 0.  , 0.  , 0.  , 0.  , 1.  , 0.  , 0.  ],
  [0.25, 0.11, 0.27, 0.01, 0.  , 0.03, 0.1 , 0.22],
  [0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 1.  ],
  [0.54, 0.18, 0.21, 0.06, 0.  , 0.  , 0.  , 0.01],
  [0.02, 0.06, 0.4 , 0.03, 0.05, 0.08, 0.01, 0.35],
  [0.09, 0.2 , 0.37, 0.11, 0.07, 0.11, 0.02, 0.03],
  [0.11, 0.05, 0.26, 0.03, 0.05, 0.34, 0.09, 0.07],
  [0.03, 0.06, 0.08, 0.08, 0.09, 0.  , 0.65, 0.01]
])

# Audio x Text: 
#  sound             Reimu    Flandre    Kochiya Sanae    Patchouli Knowlege    Rem    Saber    Matou Sakura    Youmu    anime girl    illustration    national anthem    bossa nova    chiptune
# --------------  -------  ---------  ---------------  --------------------  -----  -------  --------------  -------  ------------  --------------  -----------------  ------------  ----------
# reimu                 0          0                0                  0         0     0                  0        0             0            0                     0             0           1
# flandre               0          0                0                  0         0     0                  0        0             1            0                     0             0           0
# sanae                 0          0                0                  0         0     0                  0        0             0            0                     0             0           1
# patchouli             0          0                0                  0         0     0                  0        0             0            1                     0             0           0
# rem1                  0          0                0                  0         0     0                  0        0             1            0                     0             0           0
# saber                 0          0                0                  0         0     0                  0        0             0            0                     1             0           0
# sakura-saber          0          0                0                  0.02      0     0.95               0        0             0            0.03                  0             0           0
# youmu                 0          0                0                  0         0     0                  0        0             1            0                     0             0           0
# british-anthem        0          0                0                  0         0     0                  0        0             0            1                     0             0           0
similarity_dicts[ModalityType.AUDIO][ModalityType.TEXT] = array([
  [0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 1.  ],
  [0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 1.  , 0.  , 0.  , 0.  , 0.  ],
  [0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 1.  ],
  [0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 1.  , 0.  , 0.  , 0.  ],
  [0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 1.  , 0.  , 0.  , 0.  , 0.  ],
  [0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 1.  , 0.  , 0.  ],
  [0.  , 0.  , 0.  , 0.02, 0.  , 0.95, 0.  , 0.  , 0.  , 0.03, 0.  , 0.  , 0.  ],
  [0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 1.  , 0.  , 0.  , 0.  , 0.  ],
  [0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 1.  , 0.  , 0.  , 0.  ]
])

#  label                 reimu    flandre    sanae    patchouli    rem1    saber    sakura-saber    youmu    british-anthem
# ------------------  -------  ---------  -------  -----------  ------  -------  --------------  -------  ----------------
# Reimu                     0          0        0            0     1          0               0      0                   0
# Flandre                   0          0        0            0     0.8        0               0      0.2                 0
# Kochiya Sanae             0          0        0            0     1          0               0      0                   0
# Patchouli Knowlege        0          0        0            0     1          0               0      0                   0
# Rem                       0          0        0            0     1          0               0      0                   0
# Saber                     0          0        0            0     1          0               0      0                   0
# Matou Sakura              0          0        0            0     1          0               0      0                   0
# Youmu                     0          0        0            0     1          0               0      0                   0
# anime girl                0          0        0            0     1          0               0      0                   0
# illustration              0          0        0            0     0          0               0      0                   1
# national anthem           0          0        0            0     0          1               0      0                   0
# bossa nova                0          0        0            1     0          0               0      0                   0
# chiptune                  1          0        0            0     0          0               0      0                   0
similarity_dicts[ModalityType.TEXT][ModalityType.AUDIO] = array([
  [0. , 0. , 0. , 0. , 1. , 0. , 0. , 0. , 0. ],
  [0. , 0. , 0. , 0. , 0.8, 0. , 0. , 0.2, 0. ],
  [0. , 0. , 0. , 0. , 1. , 0. , 0. , 0. , 0. ],
  [0. , 0. , 0. , 0. , 1. , 0. , 0. , 0. , 0. ],
  [0. , 0. , 0. , 0. , 1. , 0. , 0. , 0. , 0. ],
  [0. , 0. , 0. , 0. , 1. , 0. , 0. , 0. , 0. ],
  [0. , 0. , 0. , 0. , 1. , 0. , 0. , 0. , 0. ],
  [0. , 0. , 0. , 0. , 1. , 0. , 0. , 0. , 0. ],
  [0. , 0. , 0. , 0. , 1. , 0. , 0. , 0. , 0. ],
  [0. , 0. , 0. , 0. , 0. , 0. , 0. , 0. , 1. ],
  [0. , 0. , 0. , 0. , 0. , 1. , 0. , 0. , 0. ],
  [0. , 0. , 0. , 1. , 0. , 0. , 0. , 0. , 0. ],
  [1. , 0. , 0. , 0. , 0. , 0. , 0. , 0. , 0. ]
])


# Audio x Vision: 
#  sound             reimu1    flandre1    sanae1    patchouli0    rem0    saber1    sakura1    youmu4
# --------------  --------  ----------  --------  ------------  ------  --------  ---------  --------
# reimu               0.09        0.11      0.17          0.1     0.11      0.06       0.22      0.13
# flandre             0.07        0.05      0.08          0.05    0.13      0.14       0.35      0.13
# sanae               0.1         0.09      0.12          0.11    0.11      0.1        0.3       0.08
# patchouli           0.09        0.1       0.12          0.11    0.14      0.1        0.14      0.2
# rem1                0.08        0.04      0.06          0.13    0.23      0.15       0.11      0.2
# saber               0.11        0.06      0.08          0.1     0.15      0.08       0.26      0.15
# sakura-saber        0.17        0.07      0.07          0.12    0.25      0.1        0.12      0.09
# youmu               0.07        0.11      0.14          0.1     0.14      0.09       0.25      0.1
# british-anthem      0.11        0.15      0.1           0.12    0.2       0.18       0.07      0.07
similarity_dicts[ModalityType.AUDIO][ModalityType.VISION] = array([
  [0.09, 0.11, 0.17, 0.1 , 0.11, 0.06, 0.22, 0.13],
  [0.07, 0.05, 0.08, 0.05, 0.13, 0.14, 0.35, 0.13],
  [0.1 , 0.09, 0.12, 0.11, 0.11, 0.1 , 0.3 , 0.08],
  [0.09, 0.1 , 0.12, 0.11, 0.14, 0.1 , 0.14, 0.2 ],
  [0.08, 0.04, 0.06, 0.13, 0.23, 0.15, 0.11, 0.2 ],
  [0.11, 0.06, 0.08, 0.1 , 0.15, 0.08, 0.26, 0.15],
  [0.17, 0.07, 0.07, 0.12, 0.25, 0.1 , 0.12, 0.09],
  [0.07, 0.11, 0.14, 0.1 , 0.14, 0.09, 0.25, 0.1 ],
  [0.11, 0.15, 0.1 , 0.12, 0.2 , 0.18, 0.07, 0.07]
])

# Vision x Audio: 
#  image         reimu    flandre    sanae    patchouli    rem1    saber    sakura-saber    youmu    british-anthem
# ----------  -------  ---------  -------  -----------  ------  -------  --------------  -------  ----------------
# reimu1         0.03       0        0               0    0.79        0            0.01     0.16                 0
# flandre1       0.04       0        0               0    0.6         0            0        0.34                 0
# sanae1         0.05       0.01     0               0    0.62        0            0        0.31                 0
# patchouli0     0.02       0        0               0    0.83        0            0        0.14                 0
# rem0           0.01       0        0               0    0.86        0            0        0.12                 0
# saber1         0.01       0.01     0               0    0.86        0            0        0.12                 0
# sakura1        0.03       0.01     0.01            0    0.61        0            0        0.32                 0
# youmu4         0.02       0        0               0    0.88        0            0        0.09                 0
similarity_dicts[ModalityType.VISION][ModalityType.AUDIO] = array([
  [0.03, 0.  , 0.  , 0.  , 0.79, 0.  , 0.01, 0.16, 0.  ],
  [0.04, 0.  , 0.  , 0.  , 0.6 , 0.  , 0.  , 0.34, 0.  ],
  [0.05, 0.01, 0.  , 0.  , 0.62, 0.  , 0.  , 0.31, 0.  ],
  [0.02, 0.  , 0.  , 0.  , 0.83, 0.  , 0.  , 0.14, 0.  ],
  [0.01, 0.  , 0.  , 0.  , 0.86, 0.  , 0.  , 0.12, 0.  ],
  [0.01, 0.01, 0.  , 0.  , 0.86, 0.  , 0.  , 0.12, 0.  ],
  [0.03, 0.01, 0.01, 0.  , 0.61, 0.  , 0.  , 0.32, 0.  ],
  [0.02, 0.  , 0.  , 0.  , 0.88, 0.  , 0.  , 0.09, 0.  ]
])